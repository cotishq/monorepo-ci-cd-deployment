FROM oven/bun:1.3.6

WORKDIR /usr/src/app

# Copy only package manager files first for caching
COPY package.json bun.lock turbo.json ./
COPY apps ./apps
COPY packages ./packages

# Install dependencies
RUN bun install

# âœ… Generate Prisma Client properly
RUN cd packages/db && bunx prisma generate

EXPOSE 8080

CMD ["bun", "run", "start:backend"]
